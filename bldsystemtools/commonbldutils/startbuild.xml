<?xml version="1.0"?>
<!DOCTYPE Build  [
  <!ELEMENT Product (Commands)>
  <!ATTLIST Product name CDATA #REQUIRED>
  <!ELEMENT Commands (Execute+ | SetEnv*)>
  <!ELEMENT Execute EMPTY>
  <!ATTLIST Execute ID CDATA #REQUIRED>
  <!ATTLIST Execute Stage CDATA #REQUIRED>
  <!ATTLIST Execute Component CDATA #REQUIRED>
  <!ATTLIST Execute Cwd CDATA #REQUIRED>
  <!ATTLIST Execute CommandLine CDATA #REQUIRED>
  <!ELEMENT SetEnv EMPTY>
  <!ATTLIST SetEnv Order ID #REQUIRED>
  <!ATTLIST SetEnv Name CDATA #REQUIRED>
  <!ATTLIST SetEnv Value CDATA #REQUIRED>
]>
<Product Name="Start Build Bootstrap">
  <Commands>
    
    <!---Environment vars should be set by BuildManager.pm -->
    <!---which is loaded from the database                 -->
    <Execute ID="1" Stage="1" Component="Make Build Dir" Cwd="%ToolsDir%\os\buildtools\bldsystemtools\commonbldutils" CommandLine="mkdir %SubstDir% " ExitOnScanlogError="y"/>
    <Execute ID="2" Stage="2" Component="Subst Build Dir" Cwd="%ToolsDir%\os\buildtools\bldsystemtools\commonbldutils" CommandLine="subst.pl -v %BuildDir% -p %SubstDir% -f" ExitOnScanlogError="y"/>
    <Execute ID="3" Stage="3" Component="Make Logs Dir" Cwd="%ToolsDir%" CommandLine="mkdir %SubstDir%\logs\%Platform%"/>
    <Execute ID="4" Stage="4" Component="Copy BuildLaunch" Cwd="%ToolsDir%\os\buildtools\bldsystemtools\commonbldutils\" CommandLine="copy BuildLaunch.xml %SubstDir%\logs\%Platform%"/>
    
    <!---Start Build Launch Client -->
    <Execute ID="5" Stage="5" Component="Build Launch Client" Cwd="%ToolsDir%" CommandLine="perl %ToolsDir%\os\buildtools\bldsystemtools\commonbldutils\start-perl.pl %ToolsDir%\os\buildtools\bldsystemtools\buildsystemtools\BuildClient.pl -d localhost:15000 -d localhost:15001 -d localhost:15002 -w 5 -c BuildLaunch" ExitOnScanlogError="y"/>;

    <!---Start Build Launch Server with Build Launch xml -->
    <Execute ID="6" Stage="6" Component="Build Launch Server" Cwd="%ToolsDir%" CommandLine="perl %ToolsDir%\os\buildtools\bldsystemtools\buildsystemtools\buildserver.pl -p 15000 -p 15001 -p 15002 -t 5 -c 5 -d %SubstDir%\logs\%Platform%\BuildLaunch.xml -p 2003 -l %SubstDir%\logs\%Platform%\%BuildNumber%.log" ExitOnScanlogError="y"/>

    <!---Start Build Glue Server with Main xml -->
    <Execute ID="7" Stage="7" Component="Build Glue Server" Cwd="%BuildDir%" CommandLine="perl %ToolsDir%\os\buildtools\bldsystemtools\buildsystemtools\buildserver.pl -p 15000 -p 15001 -p 15002 -t 5 -c 5 -d %CleanSourceDir%\os\deviceplatformrelease\symbianosbld\cedarutils\%BuildBaseName%.xml -e %LogsDir%\BuildLaunch.xml -p 2003 -l %LogsDir%\%BuildBaseName%.log" ExitOnScanlogError="y"/>

    <!---Start Build Glue Server with Postbuild xml -->
    <Execute ID="8" Stage="8" Component="Build Glue Server for PostBuild" Cwd="%BuildDir%" CommandLine="perl %ToolsDir%\os\buildtools\bldsystemtools\buildsystemtools\buildserver.pl -p 15000 -p 15001 -p 15002 -t 5 -c 5 -d %CleanSourceDir%\os\buildtools\bldsystemtools\commonbldutils\PostBuild.xml -e %LogsDir%\BuildLaunch.xml -p 2003 -l %LogsDir%\postbuild.log" ExitOnScanlogError="y"/>
  </Commands>
</Product>
